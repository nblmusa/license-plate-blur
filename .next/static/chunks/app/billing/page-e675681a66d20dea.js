(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[713],{1738:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},5817:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},9409:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2851:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},2369:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},8377:function(e,r,t){Promise.resolve().then(t.bind(t,3540))},3540:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return w}});var a=t(7437),s=t(2265),n=t(6110),i=t(3023),l=t(8520),o=t(3082),d=t(2621),c=t(4033),u=t(1396),m=t.n(u),f=t(3715),h=t(1738),p=t(8244),x=t(9409),g=t(9036),v=t(2851),b=t(2369),y=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,y.Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var j=t(5817);function w(){let[e,r]=(0,s.useState)(!0),[t,u]=(0,s.useState)(null),[y,w]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),_=(0,o.createClientComponentClient)(),{toast:E}=(0,d.pm)(),C=(0,c.useRouter)();async function Z(){try{r(!0);let e=await fetch("/api/billing/subscription");if(!e.ok)throw Error("Failed to load subscription");let t=await e.json();u(t);let{data:a,error:s}=await _.from("invoices").select("*").order("created_at",{ascending:!1});if(s)throw s;w(a||[]);let{data:n,error:i}=await _.from("usage_records").select("images_processed, month_year").order("month_year",{ascending:!1}).limit(6);if(i)throw i;S(n||[])}catch(e){console.error("Error loading billing data:",e),E({title:"Error",description:"Failed to load billing information",variant:"destructive"})}finally{r(!1)}}async function T(){try{r(!0);let e=await fetch("/api/billing/portal",{method:"POST"}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to open billing portal");if(!t.url)throw Error("No portal URL received");C.push(t.url)}catch(e){console.error("Error opening customer portal:",e),E({title:"Error",description:e instanceof Error?e.message:"Failed to open billing portal",variant:"destructive"})}finally{r(!1)}}function M(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}return((0,s.useEffect)(()=>{Z()},[]),e)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8 md:py-12",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 mb-4 rounded-full bg-gradient-to-r from-blue-500/10 to-indigo-500/10 dark:from-blue-500/5 dark:to-indigo-500/5",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"text-sm font-medium text-primary",children:"Billing & Usage"})]}),(0,a.jsx)("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-800 to-indigo-800 dark:from-blue-400 dark:via-blue-300 dark:to-blue-200",children:"Billing"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your subscription and view usage"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>Z(),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),"Refresh"]}),(0,a.jsxs)(i.z,{size:"sm",className:"gap-2 bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-600 hover:from-blue-700 hover:via-blue-800 hover:to-indigo-700",onClick:T,children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),"Manage Subscription"]})]})]}),(0,a.jsx)(n.Zb,{className:"p-6 hover:shadow-lg transition-all duration-300 bg-gradient-to-br from-white via-blue-50/10 to-blue-100/5 dark:from-gray-800 dark:via-blue-900/3 dark:to-blue-800/5 border-blue-100/30 dark:border-blue-800/30",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Current Plan"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("span",{className:"font-medium",children:null==t?void 0:t.plan.name}),(null==t?void 0:t.plan.id)==="pro"&&(0,a.jsx)("div",{className:"bg-primary/10 text-primary px-2 py-0.5 rounded text-xs font-medium",children:"Pro Plan"})]}),(null==t?void 0:t.subscription)&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Current period ends ",M(t.subscription.currentPeriodEnd),t.subscription.cancelAtPeriodEnd&&" (Cancels at end of period)"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)(i.z,{variant:"outline",className:"gap-2",asChild:!0,children:(0,a.jsxs)(m(),{href:"/pricing",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4"}),"Compare Plans"]})}),(null==t?void 0:t.plan.id)==="free"&&(0,a.jsx)(i.z,{className:"gap-2 bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-600 hover:from-blue-700 hover:via-blue-800 hover:to-indigo-700",asChild:!0,children:(0,a.jsxs)(m(),{href:"/pricing",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),"Upgrade Now"]})})]})]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)(n.Zb,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 bg-gradient-to-br from-white via-blue-50/10 to-blue-100/5 dark:from-gray-800 dark:via-blue-900/3 dark:to-blue-800/5 border-blue-100/30 dark:border-blue-800/30",children:[(0,a.jsx)("div",{className:"p-6 border-b border-blue-100/30 dark:border-blue-800/30",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Usage History"})}),(0,a.jsx)("div",{className:"p-6",children:k.length>0?(0,a.jsx)("div",{className:"space-y-4",children:k.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:e.month_year}),(0,a.jsxs)("span",{children:[e.images_processed," images"]})]}),(0,a.jsx)(l.E,{value:e.images_processed/t.plan.limits.imagesPerMonth*100,className:"h-2"})]},e.month_year))}):(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No usage data available"})})]}),(0,a.jsxs)(n.Zb,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 bg-gradient-to-br from-white via-blue-50/10 to-blue-100/5 dark:from-gray-800 dark:via-blue-900/3 dark:to-blue-800/5 border-blue-100/30 dark:border-blue-800/30",children:[(0,a.jsx)("div",{className:"p-6 border-b border-blue-100/30 dark:border-blue-800/30",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Invoice History"})}),(0,a.jsx)("div",{className:"p-6",children:y.length>0?(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>{var r;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-medium",children:(r=e.amount_paid,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r/100))}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:M(e.created_at)})]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:e.invoice_pdf,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)(N,{className:"h-4 w-4"}),(0,a.jsx)(j.Z,{className:"h-4 w-4"})]})})]},e.id)})}):(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No invoices available"})})]})]})]})})}},3023:function(e,r,t){"use strict";t.d(r,{d:function(){return o},z:function(){return d}});var a=t(7437),s=t(2265),n=t(7256),i=t(9213),l=t(9311);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:s,size:i,className:t})),ref:r,...c})});d.displayName="Button"},6110:function(e,r,t){"use strict";t.d(r,{Zb:function(){return i}});var a=t(7437),s=t(2265),n=t(9311);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},8520:function(e,r,t){"use strict";t.d(r,{E:function(){return l}});var a=t(7437),s=t(2265),n=t(3632),i=t(9311);let l=s.forwardRef((e,r)=>{let{className:t,value:s=0,...l}=e,o=Math.min(Math.max(0,Number(s)||0),100);return(0,a.jsx)(n.fC,{ref:r,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...l,children:(0,a.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-o,"%)")}})})});l.displayName=n.fC.displayName},2621:function(e,r,t){"use strict";t.d(r,{pm:function(){return m}});var a=t(2265);let s=0,n=new Map,i=e=>{if(n.has(e))return;let r=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},5e3);n.set(e,r)},l=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...r}=e,t=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,r]=a.useState(d);return a.useEffect(()=>(o.push(r),()=>{let e=o.indexOf(r);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9311:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(7042),s=t(4769);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}},4033:function(e,r,t){e.exports=t(290)}},function(e){e.O(0,[895,491,732,583,971,864,744],function(){return e(e.s=8377)}),_N_E=e.O()}]);